(function(){var c,t,n,a,s=[].indexOf||function(i){for(var e=0,t=this.length;e<t;e++)if(e in this&&this[e]===i)return e;return-1};(c=jQuery).fn.disableClientSideValidations=function(){return ClientSideValidations.disable(this),this},c.fn.enableClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.enablers.form(this)}),this.filter(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)}),this},c.fn.resetClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.reset(this)}),this},c.fn.validate=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return c(this).enableClientSideValidations()}),this},c.fn.isValid=function(i){var e;return(e=c(this[0])).is("form")?n(e,i):t(e,a(this[0].name,i))},a=function(i,e){var t,n;if(t=i.match(/\[(\w+_attributes)\].*\[(\w+)\]$/))for(n in e)e[n],n.match("\\["+t[1]+"\\].*\\[\\]\\["+t[2]+"\\]$")&&(i=i.replace(/\[[\da-z_]+\]\[(\w+)\]$/g,"[][$1]"));return e[i]||{}},n=function(i,e){var t;return i.trigger("form:validate:before.ClientSideValidations"),t=!0,i.find(ClientSideValidations.selectors.validate_inputs).each(function(){return c(this).isValid(e)||(t=!1),!0}),t?i.trigger("form:validate:pass.ClientSideValidations"):i.trigger("form:validate:fail.ClientSideValidations"),i.trigger("form:validate:after.ClientSideValidations"),t},t=function(d,u){var i,e,t,f,n,a,l;return d.trigger("element:validate:before.ClientSideValidations"),a=function(){return d.trigger("element:validate:pass.ClientSideValidations").data("valid",null)},f=function(i){return d.trigger("element:validate:fail.ClientSideValidations",i).data("valid",!1),!1},i=function(){return!1!==d.trigger("element:validate:after.ClientSideValidations").data("valid")},t=function(i){var e,t,n,a,l,r,s,o;for(n in s=!0,i)if(e=i[n],u[n]){for(t=0,a=(r=u[n]).length;t<a;t++)if(o=r[t],l=e.call(i,d,o)){s=f(l);break}if(!s)break}return s},0<=d.attr("name").search(/\[([^\]]*?)\]$/)&&(e=d.attr("name").replace(/\[([^\]]*?)\]$/,"[_destroy]"),"1"===c("input[name='"+e+"']").val())?a():!1===d.data("changed")||(d.data("changed",!1),n=ClientSideValidations.validators.local,l=ClientSideValidations.validators.remote,t(n)&&t(l)&&a()),i()},void 0===window.ClientSideValidations&&(window.ClientSideValidations={}),void 0===window.ClientSideValidations.forms&&(window.ClientSideValidations.forms={}),window.ClientSideValidations.selectors={inputs:':input:not(button):not([type="submit"])[name]:visible:enabled',validate_inputs:":input:enabled:visible[data-validate]",forms:"form[data-validate]"},window.ClientSideValidations.reset=function(i){var e,t;for(t in e=c(i),ClientSideValidations.disable(i),i.ClientSideValidations.settings.validators)i.ClientSideValidations.removeError(e.find("[name='"+t+"']"));return ClientSideValidations.enablers.form(i)},window.ClientSideValidations.disable=function(i){var e;return(e=c(i)).off(".ClientSideValidations"),e.is("form")?ClientSideValidations.disable(e.find(":input")):(e.removeData("valid"),e.removeData("changed"),e.filter(":input").each(function(){return c(this).removeAttr("data-validate")}))},window.ClientSideValidations.enablers={form:function(t){var e,i,n,a;for(n in e=c(t),t.ClientSideValidations={settings:window.ClientSideValidations.forms[e.attr("id")],addError:function(i,e){return ClientSideValidations.formBuilders[t.ClientSideValidations.settings.type].add(i,t.ClientSideValidations.settings,e)},removeError:function(i){return ClientSideValidations.formBuilders[t.ClientSideValidations.settings.type].remove(i,t.ClientSideValidations.settings)}},a={"submit.ClientSideValidations":function(i){e.isValid(t.ClientSideValidations.settings.validators)||(i.preventDefault(),i.stopImmediatePropagation())},"ajax:beforeSend.ClientSideValidations":function(i){i.target===this&&e.isValid(t.ClientSideValidations.settings.validators)},"form:validate:after.ClientSideValidations":function(i){ClientSideValidations.callbacks.form.after(e,i)},"form:validate:before.ClientSideValidations":function(i){ClientSideValidations.callbacks.form.before(e,i)},"form:validate:fail.ClientSideValidations":function(i){ClientSideValidations.callbacks.form.fail(e,i)},"form:validate:pass.ClientSideValidations":function(i){ClientSideValidations.callbacks.form.pass(e,i)}})i=a[n],e.on(n,i);return e.find(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)})},input:function(i){var a,e,l,r,s,t;for(r in e=c(i),s=i.form,a=c(s),t={"focusout.ClientSideValidations":function(){c(this).isValid(s.ClientSideValidations.settings.validators)},"change.ClientSideValidations":function(){c(this).data("changed",!0)},"element:validate:after.ClientSideValidations":function(i){ClientSideValidations.callbacks.element.after(c(this),i)},"element:validate:before.ClientSideValidations":function(i){ClientSideValidations.callbacks.element.before(c(this),i)},"element:validate:fail.ClientSideValidations":function(i,e){var t;t=c(this),ClientSideValidations.callbacks.element.fail(t,e,function(){return s.ClientSideValidations.addError(t,e)},i)},"element:validate:pass.ClientSideValidations":function(i){var e;e=c(this),ClientSideValidations.callbacks.element.pass(e,function(){return s.ClientSideValidations.removeError(e)},i)}})l=t[r],e.filter(":not(:radio):not([id$=_confirmation])").each(function(){return c(this).attr("data-validate",!0)}).on(r,l);return e.filter(":checkbox").on("change.ClientSideValidations",function(){c(this).isValid(s.ClientSideValidations.settings.validators)}),e.filter("[id$=_confirmation]").each(function(){var i,e,t,n;if(i=c(this),(e=a.find("#"+this.id.match(/(.+)_confirmation/)[1]+":input"))[0]){for(r in n=[],t={"focusout.ClientSideValidations":function(){e.data("changed",!0).isValid(s.ClientSideValidations.settings.validators)},"keyup.ClientSideValidations":function(){e.data("changed",!0).isValid(s.ClientSideValidations.settings.validators)}})l=t[r],n.push(c("#"+i.attr("id")).on(r,l));return n}})}},window.ClientSideValidations.validators={all:function(){return c.extend({},ClientSideValidations.validators.local,ClientSideValidations.validators.remote)},local:{absence:function(i,e){if(!/^\s*$/.test(i.val()||""))return e.message},presence:function(i,e){if(/^\s*$/.test(i.val()||""))return e.message},acceptance:function(i,e){var t;switch(i.attr("type")){case"checkbox":if(!i.prop("checked"))return e.message;break;case"text":if(i.val()!==((null!=(t=e.accept)?t.toString():void 0)||"1"))return e.message}},format:function(i,e){var t;if(t=this.presence(i,e)){if(!0===e.allow_blank)return;return t}return e["with"]&&!new RegExp(e["with"].source,e["with"].options).test(i.val())?e.message:e.without&&new RegExp(e.without.source,e.without.options).test(i.val())?e.message:void 0},numericality:function(i,e){var t,n,a,l,r,s;if(s=c.trim(i.val()),!ClientSideValidations.patterns.numericality.test(s)){if(!0===e.allow_blank&&this.presence(i,{message:e.messages.numericality}))return;return e.messages.numericality}if(s=s.replace(new RegExp("\\"+ClientSideValidations.number_format.delimiter,"g"),"").replace(new RegExp("\\"+ClientSideValidations.number_format.separator,"g"),"."),e.only_integer&&!/^[+-]?\d+$/.test(s))return e.messages.only_integer;for(n in t={greater_than:">",greater_than_or_equal_to:">=",equal_to:"==",less_than:"<",less_than_or_equal_to:"<="},l=c(i[0].form),t)if(r=t[n],null!=e[n]){if(null==(a=!isNaN(parseFloat(e[n]))&&isFinite(e[n])?e[n]:1===l.find("[name*="+e[n]+"]").length?l.find("[name*="+e[n]+"]").val():void 0)||""===a)return;if(!new Function("return "+s+" "+r+" "+a)())return e.messages[n]}return!e.odd||parseInt(s,10)%2?e.even&&parseInt(s,10)%2?e.messages.even:void 0:e.messages.odd},length:function(i,e){var t,n,a,l,r,s,o;if(o=e.js_tokenizer||"split('')",s=new Function("element","return (element.val()."+o+" || '').length")(i),t={is:"==",minimum:">=",maximum:"<="},(n={}).message=e.is?e.messages.is:e.minimum?e.messages.minimum:void 0,l=this.presence(i,n)){if(!0===e.allow_blank)return;return l}for(a in t)if(r=t[a],e[a]&&!new Function("return "+s+" "+r+" "+e[a])())return e.messages[a]},exclusion:function(i,a){var e,t,l,n,r;if(t=this.presence(i,a)){if(!0===a.allow_blank)return;return t}return a["in"]&&(n=i.val(),0<=s.call(function(){var i,e,t,n;for(n=[],i=0,e=(t=a["in"]).length;i<e;i++)l=t[i],n.push(l.toString());return n}(),n))?a.message:a.range&&(e=a.range[0],r=a.range[1],i.val()>=e&&i.val()<=r)?a.message:void 0},inclusion:function(i,a){var e,t,l,n,r;if(t=this.presence(i,a)){if(!0===a.allow_blank)return;return t}if(a["in"]){if(n=i.val(),0<=s.call(function(){var i,e,t,n;for(n=[],i=0,e=(t=a["in"]).length;i<e;i++)l=t[i],n.push(l.toString());return n}(),n))return;return a.message}if(a.range){if(e=a.range[0],r=a.range[1],i.val()>=e&&i.val()<=r)return;return a.message}},confirmation:function(i,e){if(i.val()!==c("#"+i.attr("id")+"_confirmation").val())return e.message},uniqueness:function(i,e){var t,n,a,l,r,s,o;if(a=i.attr("name"),/_attributes\]\[\d/.test(a)&&(l=(n=a.match(/^(.+_attributes\])\[\d+\](.+)$/))[1],r=n[2],o=i.val(),l&&r&&(t=i.closest("form"),s=!0,t.find(':input[name^="'+l+'"][name$="'+r+'"]').each(function(){if(c(this).attr("name")!==a){if(c(this).val()===o)return s=!1,c(this).data("notLocallyUnique",!0);if(c(this).data("notLocallyUnique"))return c(this).removeData("notLocallyUnique").data("changed",!0)}}),!s)))return e.message}},remote:{uniqueness:function(i,e){var t,n,a,l,r,s,o,d;if(a=ClientSideValidations.validators.local.presence(i,e)){if(!0===e.allow_blank)return;return a}if((t={}).case_sensitive=!!e.case_sensitive,e.id&&(t.id=e.id),e.scope)for(n in t.scope={},r=e.scope)s=r[n],d=i.attr("name").replace(/\[\w+\]$/,"["+n+"]"),o=c("[name='"+d+"']"),c("[name='"+d+"']:checkbox").each(function(){if(this.checked)return o=this}),o[0]&&o.val()!==s?(t.scope[n]=o.val(),o.unbind("change."+i.id).bind("change."+i.id,function(){return i.trigger("change.ClientSideValidations"),i.trigger("focusout.ClientSideValidations")})):t.scope[n]=s;if(/_attributes\]/.test(i.attr("name"))?(l=i.attr("name").match(/\[\w+_attributes\]/g).pop().match(/\[(\w+)_attributes\]/).pop(),l+=/(\[\w+\])$/.exec(i.attr("name"))[1]):l=i.attr("name"),e["class"]&&(l=e["class"]+"["+l.split("[")[1]),t[l]=i.val(),200===c.ajax({url:ClientSideValidations.remote_validators_url_for("uniqueness"),data:t,async:!1,cache:!1}).status)return e.message}}},window.ClientSideValidations.remote_validators_url_for=function(i){return null!=ClientSideValidations.remote_validators_prefix?"//"+window.location.host+"/"+ClientSideValidations.remote_validators_prefix+"/validators/"+i:"//"+window.location.host+"/validators/"+i},window.ClientSideValidations.disableValidators=function(){var i,e,t;if(void 0!==window.ClientSideValidations.disabled_validators){for(t in e=[],i=window.ClientSideValidations.validators.remote)i[t],0<=s.call(window.ClientSideValidations.disabled_validators,t)?e.push(delete window.ClientSideValidations.validators.remote[t]):e.push(void 0);return e}},window.ClientSideValidations.formBuilders={"ActionView::Helpers::FormBuilder":{add:function(i,e,t){var n,a,l,r;return n=c(i[0].form),!1!==i.data("valid")&&null==n.find("label.message[for='"+i.attr("id")+"']")[0]&&(a=c(e.input_tag),r=c(e.label_tag),l=n.find("label[for='"+i.attr("id")+"']:not(.message)"),i.attr("autofocus")&&i.attr("autofocus",!1),i.before(a),a.find("span#input_tag").replaceWith(i),a.find("label.message").attr("for",i.attr("id")),r.find("label.message").attr("for",i.attr("id")),r.insertAfter(l),r.find("label#label_tag").replaceWith(l)),n.find("label.message[for='"+i.attr("id")+"']").text(t)},remove:function(i,e){var t,n,a,l,r;if(n=c(i[0].form),t=c(e.input_tag).attr("class"),a=i.closest("."+t.replace(/\ /g,".")),r=(l=n.find("label[for='"+i.attr("id")+"']:not(.message)")).closest("."+t),a[0])return a.find("#"+i.attr("id")).detach(),a.replaceWith(i),l.detach(),r.replaceWith(l)}}},window.ClientSideValidations.patterns={numericality:/^(-|\+)?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/},window.ClientSideValidations.callbacks={element:{after:function(){},before:function(){},fail:function(i,e,t){return t()},pass:function(i,e){return e()}},form:{after:function(){},before:function(){},fail:function(){},pass:function(){}}},window.ClientSideValidations.event=null!=window.Turbolinks&&window.Turbolinks.supported?null!=window.Turbolinks.EVENTS?"page:change":"turbolinks:load":"ready",c(document).bind(window.ClientSideValidations.event,function(){return ClientSideValidations.disableValidators(),c(ClientSideValidations.selectors.forms).validate()})}).call(this);